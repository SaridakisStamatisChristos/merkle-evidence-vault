groups:
  - name: vault.rules
    rules:
      - alert: VaultAPIDown
        expr: up{job="vault-api"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "vault-api is down"

      - alert: MerkleEngineDown
        expr: up{job="merkle-engine"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "merkle-engine is down"

      - alert: CheckpointSvcDown
        expr: up{job="checkpoint-svc"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "checkpoint-svc is down"

      - alert: CheckpointSigningFailures
        expr: increase(checkpoint_svc_sign_failures_total[10m]) > 0
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "checkpoint-svc encountered signing failures"
