# CONFIDENCE.yaml — Merkle Evidence Vault v0.1.4
# Snapshot — proof-pack consolidation update
# Generated: 2026-03-01 | Model: beta | Prior: conservative

model:
  type: beta
  conservative_prior: true
  propagation: enabled
  minimum_effective_confidence: 0.65
  block_production_claim_below: 0.80

system:
  raw_confidence: 0.90
  effective_confidence: 0.87
  weakest_link: pipeline.adversarial
  production_ready: false
  reason: >
    Control coverage is materially improved and evidence is now consolidated in
    a dated proof-pack, increasing auditability/reviewability rather than runtime
    assurance. Production claim remains blocked pending fresh executed drill
    artifacts (restore/game-day), pinned CI success URL, and fully populated
    SBOM/signing verification outputs in the proof-pack.

posture:
  assessment_version: v0.1.4
  assessment_date: 2026-03-01
  evidence_pack: evidence/proof-pack/2026-03-01
  evidence_pack_commit_sha: dda998ae8ebcdb2f9f68efb6d15d64bde9324f8d
  change_type: evidence_consolidation
  release_claim: pre_production_only

verified_evidence:
  ci:
    artifact: evidence/proof-pack/2026-03-01/ci_run.txt
    commit_sha: dda998ae8ebcdb2f9f68efb6d15d64bde9324f8d
    execution_state: packaged_unpinned_run_url
  restore_drill:
    artifact: evidence/proof-pack/2026-03-01/restore_drill_summary.json
    source_scripts:
      - scripts/drill_restore.sh
      - scripts/drill_restore.ps1
    execution_state: packaged_pending_latest_run_copy
  game_day:
    artifact: evidence/proof-pack/2026-03-01/game_day_report.json
    source_scripts:
      - scripts/game_day_merkle_down.sh
      - scripts/game_day_merkle_down.ps1
    execution_state: packaged_pending_latest_run_copy
  supply_chain:
    sbom_dir: evidence/proof-pack/2026-03-01/sbom
    signing_dir: evidence/proof-pack/2026-03-01/signing
    execution_state: packaged_pending_latest_artifact_copy
  auth_policy:
    artifact: evidence/proof-pack/2026-03-01/auth_policy_matrix.md
    execution_state: packaged

assumptions:
  - "CI run URL will be replaced with latest successful workflow link before external review."
  - "Restore drill output will be copied from artifacts/drills/<timestamp>/ into proof-pack."
  - "Game-day report will be copied with MTTR and verification fields populated."
  - "SBOM and signing outputs will be copied from release-governance CI artifacts."

out_of_scope_this_update:
  - "No runtime behavior changes in service code paths."
  - "No GitHub branch protection or workflow-required-check settings changes."
  - "No SLO target definition changes."

artifacts:
  merkle-engine:
    description: "Rust RFC6962 tree, proof generation, checkpoint primitives"
    raw:
      spec:        0.95
      impl:        0.89
      verify:      0.86
      adversarial: 0.80
      ops:         0.88
    effective: 0.80
    upstream: []
    downstream: [vault-api, checkpoint-svc, verifier-cli]

  vault-api:
    description: "Go REST+gRPC ingestion/query API"
    raw:
      spec:        0.92
      impl:        0.89
      verify:      0.88
      adversarial: 0.87
      ops:         0.91
    effective: 0.85
    upstream: [merkle-engine]
    downstream: [audit-trail, bundle-export, frontend]

  checkpoint-svc:
    description: "Periodic checkpoint signing and persistence"
    raw:
      spec:        0.93
      impl:        0.89
      verify:      0.88
      adversarial: 0.85
      ops:         0.90
    effective: 0.80
    upstream: [merkle-engine]
    downstream: []

  verifier-cli:
    description: "Offline .evb bundle verification (pure Go)"
    raw:
      spec:        0.94
      impl:        0.91
      verify:      0.92
      adversarial: 0.88
      ops:         0.94
    effective: 0.82
    upstream: [merkle-engine, bundle-format]

  bundle-format:
    description: ".evb tar+zstd archive with manifest + proofs"
    raw:
      spec:        0.91
      impl:        0.88
      verify:      0.86
      adversarial: 0.82
      ops:         0.89
    effective: 0.82
    upstream: []
    downstream: [verifier-cli, vault-api]

  persistence:
    description: "Postgres append-only schema, RLS, migrations"
    raw:
      spec:        0.95
      impl:        0.92
      verify:      0.90
      adversarial: 0.88
      ops:         0.91
    effective: 0.88
    upstream: []
    downstream: [vault-api, audit-trail]

  pipeline:
    description: "Redpanda ingest consumer + publisher"
    raw:
      spec:        0.88
      impl:        0.86
      verify:      0.83
      adversarial: 0.79
      ops:         0.87
    effective: 0.79
    upstream: [merkle-engine]
    downstream: []

  audit-trail:
    description: "Append-only audit log API"
    raw:
      spec:        0.91
      impl:        0.89
      verify:      0.88
      adversarial: 0.85
      ops:         0.90
    effective: 0.82
    upstream: [vault-api, persistence]

  frontend:
    description: "React audit dashboard"
    raw:
      spec:        0.86
      impl:        0.85
      verify:      0.82
      adversarial: 0.82
      ops:         0.83
    effective: 0.80
    upstream: [vault-api]

  infra:
    description: "Docker, K8s, CI, observability"
    raw:
      spec:        0.92
      impl:        0.90
      verify:      0.86
      adversarial: 0.85
      ops:         0.92
    effective: 0.86
    upstream: []
    downstream: [vault-api, merkle-engine, checkpoint-svc]

quality_gate:
  ci_fails_if:
    confidence_yaml_missing:                true
    any_effective_lt:                       0.65
    production_claimed_without_threshold:   true
